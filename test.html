<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Cast Test</title>
  <!-- 載入 Cast Sender SDK -->
  <script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
</head>
<body>
  <!-- Chromecast 按鈕 -->
  <google-cast-launcher id="cast-button"></google-cast-launcher>
  <button onclick="cast.framework.CastContext.getInstance().requestSession()">Cast</button>

  <script>
    window['__onGCastApiAvailable'] = function(isAvailable) {
      if (isAvailable) {
        alert("Cast API is available");

        const context = cast.framework.CastContext.getInstance();
        context.setOptions({
          receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
          autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
        });

        // 檢查 state
        context.addEventListener(
          cast.framework.CastContextEventType.CAST_STATE_CHANGED,
          function(event) {
            alert('[Cast State]', event.castState);
          }
        );
      } else {
        alert("Cast API not available");
      }
    };
  </script>

  <style>
    /* 強制讓按鈕看得見（測試用途） */
    google-cast-launcher#cast-button {
      display: inline-block !important;
      width: 48px;
      height: 48px;
      --cast-button-color: white;
      background-color: black;
    }
  </style>
</body>
</html>